# ğŸ“Š êµ¬ë…ì, ì¢‹ì•„ìš” ë°ì´í„° ìˆ˜ì§‘ API ì†Œëª¨ëŸ‰

## í˜„ì¬ ìƒí™©

### ì´ë¯¸ ìˆ˜ì§‘ ì¤‘ì¸ ë°ì´í„°
- âœ… **ì¡°íšŒìˆ˜** (viewCount): VPH ì—…ë°ì´íŠ¸ë¡œ 1ì‹œê°„ë§ˆë‹¤ ìˆ˜ì§‘
- âœ… **ì¢‹ì•„ìš”** (likeCount): ê²€ìƒ‰ ì‹œ `videos.list`ì—ì„œ í•¨ê»˜ ê°€ì ¸ì˜´
- âœ… **êµ¬ë…ì** (subscriberCount): ê²€ìƒ‰ ì‹œ `channels.list`ì—ì„œ í•¨ê»˜ ê°€ì ¸ì˜´

### VPH ì—…ë°ì´íŠ¸ (í˜„ì¬)
- **API**: `videos.list` (part=statistics)
- **ë¹„ìš©**: 1 unit per 50ê°œ
- **ìˆ˜ì§‘ ë°ì´í„°**: ì¡°íšŒìˆ˜ë§Œ
- **ì£¼ê¸°**: 1ì‹œê°„ë§ˆë‹¤

---

## ê¶Œì¥ ìˆ˜ì§‘ ì£¼ê¸°

### ì¡°íšŒìˆ˜ (viewCount)
- **ì£¼ê¸°**: **1ì‹œê°„ë§ˆë‹¤** (VPH ê³„ì‚°ì„ ìœ„í•´ í•„ìš”)
- **API**: `videos.list` (part=statistics)
- **ë¹„ìš©**: 1 unit per 50ê°œ

### ì¢‹ì•„ìš” (likeCount) + êµ¬ë…ì (subscriberCount)
- **ì£¼ê¸°**: **1ì¼ë§ˆë‹¤** (ë³€í™”ê°€ ëŠë¦¬ë¯€ë¡œ)
- **API**: 
  - `videos.list` (part=statistics) - ì¢‹ì•„ìš”
  - `channels.list` (part=statistics) - êµ¬ë…ì
- **ë¹„ìš©**: 2 units per 50ê°œ (videos + channels)

---

## ì¡°íšŒìˆ˜, ì¢‹ì•„ìš”, êµ¬ë…ì ìˆ˜ì§‘ ë¹„ìš© (ê¶Œì¥ ì£¼ê¸°)

### API ì—”ë“œí¬ì¸íŠ¸ ë° ë¹„ìš©

#### 1. ì¡°íšŒìˆ˜ (videos.list) - 1ì‹œê°„ë§ˆë‹¤
- **ì—”ë“œí¬ì¸íŠ¸**: `videos.list`
- **íŒŒë¼ë¯¸í„°**: `part=statistics`
- **ë¹„ìš©**: **1 unit per 50ê°œ**
- **ì£¼ê¸°**: **1ì‹œê°„ë§ˆë‹¤** (VPH ê³„ì‚° í•„ìš”)
- **ìˆ˜ì§‘ ë°ì´í„°**: `viewCount` (ì¡°íšŒìˆ˜)

#### 2. ì¢‹ì•„ìš” (videos.list) - 1ì¼ë§ˆë‹¤
- **ì—”ë“œí¬ì¸íŠ¸**: `videos.list`
- **íŒŒë¼ë¯¸í„°**: `part=statistics`
- **ë¹„ìš©**: **1 unit per 50ê°œ**
- **ì£¼ê¸°**: **1ì¼ë§ˆë‹¤**
- **ìˆ˜ì§‘ ë°ì´í„°**: `likeCount` (ì¢‹ì•„ìš”)

#### 3. êµ¬ë…ì ìˆ˜ (channels.list) - 1ì¼ë§ˆë‹¤
- **ì—”ë“œí¬ì¸íŠ¸**: `channels.list`
- **íŒŒë¼ë¯¸í„°**: `part=statistics`
- **ë¹„ìš©**: **1 unit per 50ê°œ**
- **ì£¼ê¸°**: **1ì¼ë§ˆë‹¤**
- **ìˆ˜ì§‘ ë°ì´í„°**: `subscriberCount` (êµ¬ë…ì ìˆ˜)

### ë¹„ìš© ê³„ì‚° (ì˜ìƒ 10,000ê°œ ê¸°ì¤€)

#### ì¡°íšŒìˆ˜ (1ì‹œê°„ë§ˆë‹¤)
- **1íšŒ ì—…ë°ì´íŠ¸**: 10,000 / 50 = **200 units**
- **í•˜ë£¨**: 200 Ã— 24 = **4,800 units**
- **ì›”ê°„**: 4,800 Ã— 30 = **144,000 units**

#### ì¢‹ì•„ìš” + êµ¬ë…ì (1ì¼ë§ˆë‹¤)
- **1íšŒ ì—…ë°ì´íŠ¸**:
  - `videos.list` (ì¢‹ì•„ìš”): 10,000 / 50 = **200 units**
  - `channels.list` (êµ¬ë…ì): 1,000 / 50 = **20 units** (ì¼ë°˜ì , í‰ê·  10ê°œ ì˜ìƒ/ì±„ë„)
  - **ì´: 220 units**
- **í•˜ë£¨**: **220 units**
- **ì›”ê°„**: 220 Ã— 30 = **6,600 units**

#### ì´ ì‚¬ìš©ëŸ‰
- **í•˜ë£¨**: 4,800 (ì¡°íšŒìˆ˜) + 220 (ì¢‹ì•„ìš”+êµ¬ë…ì) = **5,020 units**
- **ì›”ê°„**: 144,000 + 6,600 = **150,600 units**

---

## í˜„ì¬ ì‚¬ìš©ëŸ‰ê³¼ ë¹„êµ

### í˜„ì¬ ì„¤ì • (ì¡°íšŒìˆ˜ë§Œ)
- **VPH ì—…ë°ì´íŠ¸** (1ì‹œê°„ë§ˆë‹¤): 4,800 units/ì¼
- **ë°ì´í„° í™•ë³´**: 4,040 units/ì¼
- **ì´ ì‚¬ìš©ëŸ‰**: 8,840 units/ì¼ (88.4%)

### ì¡°íšŒìˆ˜(1ì‹œê°„) + ì¢‹ì•„ìš”+êµ¬ë…ì(1ì¼) ì¶”ê°€ ì‹œ
- **ì¡°íšŒìˆ˜ ì—…ë°ì´íŠ¸** (1ì‹œê°„ë§ˆë‹¤): 4,800 units/ì¼
- **ì¢‹ì•„ìš”+êµ¬ë…ì ì—…ë°ì´íŠ¸** (1ì¼ë§ˆë‹¤): 220 units/ì¼
- **ë°ì´í„° í™•ë³´**: 4,040 units/ì¼
- **ì´ ì‚¬ìš©ëŸ‰**: 4,800 + 220 + 4,040 = **9,060 units/ì¼** (90.6%)

### ì´ ì‚¬ìš©ëŸ‰ ë¹„êµ

| í•­ëª© | í˜„ì¬ (ì¡°íšŒìˆ˜ë§Œ) | ì¡°íšŒìˆ˜(1h) + ì¢‹ì•„ìš”+êµ¬ë…ì(1d) |
|------|---------------|---------------------------|
| **ì¡°íšŒìˆ˜ ì—…ë°ì´íŠ¸** | 4,800 units/ì¼ | 4,800 units/ì¼ |
| **ì¢‹ì•„ìš”+êµ¬ë…ì ì—…ë°ì´íŠ¸** | 0 units/ì¼ | **220 units/ì¼** |
| **ë°ì´í„° í™•ë³´** | 4,040 units/ì¼ | 4,040 units/ì¼ |
| **ì´ ì‚¬ìš©ëŸ‰** | 8,840 units/ì¼ | **9,060 units/ì¼** |
| **ì‚¬ìš©ë¥ ** | 88.4% | **90.6%** |
| **ì•ˆì „ ë§ˆì§„** | 1,160 units (11.6%) | **940 units (9.4%)** |

---

## ê¶Œì¥ ì„¤ì • (ì ìš© ì™„ë£Œ) âœ…

### ì¡°íšŒìˆ˜: 1ì‹œê°„ë§ˆë‹¤
- **ì´ìœ **: VPH ê³„ì‚°ì„ ìœ„í•´ ì‹œê°„ ë‹¨ìœ„ ë°ì´í„° í•„ìš”
- **ë¹„ìš©**: 4,800 units/ì¼

### ì¢‹ì•„ìš” + êµ¬ë…ì: 1ì¼ë§ˆë‹¤
- **ì´ìœ **: ë³€í™”ê°€ ëŠë¦¬ë¯€ë¡œ ì¼ ë‹¨ìœ„ë¡œ ì¶©ë¶„
- **ë¹„ìš©**: 220 units/ì¼
- **ì ˆê° íš¨ê³¼**: 1ì‹œê°„ë§ˆë‹¤ ì—…ë°ì´íŠ¸ ì‹œ 5,280 units/ì¼ â†’ 1ì¼ë§ˆë‹¤ 220 units/ì¼
- **ì ˆê°ëŸ‰**: **5,060 units/ì¼** (95.8% ì ˆê°)

### ì´ ì‚¬ìš©ëŸ‰
- **í•˜ë£¨**: 9,060 units (90.6%)
- **ì•ˆì „ ë§ˆì§„**: 940 units (9.4%)

---

## êµ¬í˜„ ë°©ë²•

### 1. ì¡°íšŒìˆ˜ ì—…ë°ì´íŠ¸ (ê¸°ì¡´ ìœ ì§€)
- **Edge Function**: `hourly-vph-updater`
- **ì£¼ê¸°**: 1ì‹œê°„ë§ˆë‹¤ (pg_cron)
- **API**: `videos.list` (part=statistics)
- **ì €ì¥**: `view_history` í…Œì´ë¸”

### 2. ì¢‹ì•„ìš” + êµ¬ë…ì ì—…ë°ì´íŠ¸ (ì‹ ê·œ)
- **Edge Function**: `daily-statistics-updater` (ì‹ ê·œ ìƒì„± í•„ìš”)
- **ì£¼ê¸°**: 1ì¼ë§ˆë‹¤ (pg_cron: `0 0 * * *`)
- **API**: 
  - `videos.list` (part=statistics) - ì¢‹ì•„ìš”
  - `channels.list` (part=statistics) - êµ¬ë…ì
- **ì €ì¥**: `videos` í…Œì´ë¸” ì—…ë°ì´íŠ¸ ë˜ëŠ” ë³„ë„ í…Œì´ë¸”

### ë°ì´í„° ì €ì¥ êµ¬ì¡°

#### ì˜µì…˜ 1: ê¸°ì¡´ videos í…Œì´ë¸” ì—…ë°ì´íŠ¸ (ê¶Œì¥)
```sql
-- videos í…Œì´ë¸”ì— ì´ë¯¸ like_count, subscriber_count ì»¬ëŸ¼ ì¡´ì¬
-- UPDATEë¡œ ì¼ì¼ ì—…ë°ì´íŠ¸
UPDATE videos 
SET 
    like_count = ...,
    subscriber_count = ...,
    updated_at = NOW()
WHERE video_id IN (...);
```

#### ì˜µì…˜ 2: ë³„ë„ íˆìŠ¤í† ë¦¬ í…Œì´ë¸” ìƒì„±
```sql
CREATE TABLE IF NOT EXISTS daily_statistics_history (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    video_id TEXT NOT NULL,
    like_count BIGINT,
    subscriber_count BIGINT,
    fetched_at TIMESTAMPTZ DEFAULT NOW(),
    created_at TIMESTAMPTZ DEFAULT NOW()
);
```

---

## ê²°ë¡ 

### ì¡°íšŒìˆ˜ (1ì‹œê°„ë§ˆë‹¤)
- **ì˜ìƒ 10,000ê°œ**: 200 units/ì‹¤í–‰
- **í•˜ë£¨**: 4,800 units
- **ì´ìœ **: VPH ê³„ì‚°ì„ ìœ„í•´ ì‹œê°„ ë‹¨ìœ„ ë°ì´í„° í•„ìˆ˜

### ì¢‹ì•„ìš” + êµ¬ë…ì (1ì¼ë§ˆë‹¤)
- **ì˜ìƒ 10,000ê°œ**: 220 units/ì‹¤í–‰
- **í•˜ë£¨**: 220 units
- **ì ˆê° íš¨ê³¼**: 1ì‹œê°„ë§ˆë‹¤ ì‹œ 5,280 units/ì¼ â†’ 1ì¼ë§ˆë‹¤ 220 units/ì¼
- **ì ˆê°ëŸ‰**: **5,060 units/ì¼** (95.8% ì ˆê°)

### ì´ ì‚¬ìš©ëŸ‰
- **í•˜ë£¨**: 9,060 units (90.6%)
- **ì•ˆì „ ë§ˆì§„**: 940 units (9.4%)
- **ë°ì´í„° í™•ë³´ ì—¬ìœ **: ì¶©ë¶„í•¨

### ê¶Œì¥ ì„¤ì • âœ…
- **ì¡°íšŒìˆ˜**: 1ì‹œê°„ë§ˆë‹¤ (VPH ê³„ì‚° í•„ìˆ˜)
- **ì¢‹ì•„ìš” + êµ¬ë…ì**: 1ì¼ë§ˆë‹¤ (ë³€í™”ê°€ ëŠë¦¬ë¯€ë¡œ ì¶©ë¶„)
- **API íš¨ìœ¨ì„±**: ìµœì í™”ë¨

