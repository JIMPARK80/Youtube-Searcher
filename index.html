<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jim's YouTube 검색기</title>
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- Firebase SDK -->
    <script>
        // Firebase SDK를 먼저 로드
        (function() {
            const script1 = document.createElement('script');
            script1.src = 'https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js';
            script1.async = false;
            document.head.appendChild(script1);
            
            const script2 = document.createElement('script');
            script2.src = 'https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js';
            script2.async = false;
            script1.onload = () => document.head.appendChild(script2);
        })();
    </script>
</head>
<body>
    <!-- Auth Section -->
    <div class="auth-section" id="authSection">
        <button class="auth-btn login-btn" id="loginBtn">로그인</button>
        <button class="auth-btn signup-btn" id="signupBtn">가입하기</button>
        <div class="user-info" id="userInfo" style="display: none;">
            <img id="userAvatar" class="user-avatar" src="" alt="User Avatar">
            <span class="user-name" id="userName" style="cursor: pointer;" title="클릭하여 프로필 수정"></span>
            <button class="logout-btn" id="logoutBtn">로그아웃</button>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="signup-modal" id="loginModal">
        <div class="signup-form">
            <button class="close-modal" id="closeLoginModal">&times;</button>
            <h2>로그인</h2>
            <div class="form-group">
                <label for="loginEmail">이메일</label>
                <input type="email" id="loginEmail" placeholder="이메일을 입력하세요">
            </div>
            <div class="form-group">
                <label for="loginPassword">비밀번호</label>
                <div class="password-wrapper">
                    <input type="password" id="loginPassword" placeholder="비밀번호를 입력하세요">
                    <button type="button" class="password-toggle" onclick="togglePassword('loginPassword', 'loginPasswordToggle')">
                        <span id="loginPasswordToggle">보기</span>
                    </button>
                </div>
            </div>
            <div class="form-buttons">
                <button class="submit-btn" id="submitLogin">로그인</button>
                <button class="cancel-btn" id="cancelLogin">취소</button>
            </div>
        </div>
    </div>

    <!-- Signup Modal -->
    <div class="signup-modal" id="signupModal">
        <div class="signup-form">
            <button class="close-modal" id="closeModal">&times;</button>
            <h2>회원 가입</h2>
            <div class="form-group">
                <label for="signupUsername">아이디</label>
                <input type="text" id="signupUsername" placeholder="아이디를 입력하세요">
            </div>
            <div class="form-group">
                <label for="signupId">이메일</label>
                <input type="email" id="signupId" placeholder="이메일을 입력하세요">
            </div>
            <div class="form-group">
                <label for="signupPassword">비밀번호</label>
                <div class="password-wrapper">
                    <input type="password" id="signupPassword" placeholder="비밀번호를 입력하세요">
                    <button type="button" class="password-toggle" onclick="togglePassword('signupPassword', 'signupPasswordToggle')">
                        <span id="signupPasswordToggle">보기</span>
                    </button>
                </div>
            </div>
            <div class="form-group">
                <label for="signupPasswordConfirm">비밀번호 확인</label>
                <div class="password-wrapper">
                    <input type="password" id="signupPasswordConfirm" placeholder="비밀번호를 다시 입력하세요">
                    <button type="button" class="password-toggle" onclick="togglePassword('signupPasswordConfirm', 'signupPasswordConfirmToggle')">
                        <span id="signupPasswordConfirmToggle">보기</span>
                    </button>
                </div>
            </div>
            <div class="form-buttons">
                <button class="submit-btn" id="submitSignup">가입하기</button>
                <button class="cancel-btn" id="cancelSignup">취소</button>
            </div>
        </div>
    </div>

    <!-- Profile Edit Modal -->
    <div class="signup-modal" id="profileEditModal">
        <div class="signup-form">
            <button class="close-modal" id="closeProfileEditModal">&times;</button>
            <h2>프로필 수정</h2>
            <div class="form-group">
                <label for="editUsername">아이디</label>
                <input type="text" id="editUsername" placeholder="아이디를 입력하세요">
            </div>
            <div class="form-group">
                <label for="editEmail">이메일</label>
                <input type="email" id="editEmail" placeholder="이메일을 입력하세요" readonly style="background: #f0f0f0;">
            </div>
            <div class="form-buttons">
                <button class="submit-btn" id="submitProfileEdit">수정하기</button>
                <button class="cancel-btn" id="cancelProfileEdit">취소</button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <h1>🎬 Jim's YouTube 채널</h1>
            <p>검색어를 입력하고 다양한 정보를 확인하세요!</p>
        </div>

        <div class="search-box">
            <div class="search-input-group">
                <input type="text" id="searchInput" placeholder="검색어를 입력하세요..." value="news" />
                <button id="searchBtn">검색</button>
            </div>
            
            <div class="search-mode-indicator" id="searchModeIndicator">
                <span class="mode-text">현재 검색 모드: 🟢 Google API</span>
            </div>

            <!-- API 키는 서버에서 자동으로 로드되므로 입력란 숨김 -->
            <div class="api-key-section" id="apiKeySection" style="display: none;">
                <input type="password" id="apiKey" style="display: none;" />
                <input type="password" id="serpApiKey" style="display: none;" />
            </div>

            <!-- View Count Filter -->
            <div class="filter-section">
                <div class="filter-group view-filter">
                    <label>조회수 필터:</label>
                    <label><input type="radio" name="viewCountFilter" value="all" checked> 전체</label>
                    <label><input type="radio" name="viewCountFilter" value="1000"> 1K+</label>
                    <label><input type="radio" name="viewCountFilter" value="10000"> 10K+</label>
                    <label><input type="radio" name="viewCountFilter" value="100000"> 100K+</label>
                    <label><input type="radio" name="viewCountFilter" value="1000000"> 1M+</label>
                    <label><input type="radio" name="viewCountFilter" value="10000000"> 10M+</label>
                </div>
                
                <!-- Subscriber Count Filter -->
                <div class="filter-group sub-filter">
                    <label>구독자 필터:</label>
                    <label><input type="radio" name="subCountFilter" value="all" checked> 전체</label>
                    <label><input type="radio" name="subCountFilter" value="0-1000"> 1-1K</label>
                    <label><input type="radio" name="subCountFilter" value="1000-10000"> 1K-10K</label>
                    <label><input type="radio" name="subCountFilter" value="10000-100000"> 10K-100K</label>
                    <label><input type="radio" name="subCountFilter" value="100000-1000000"> 100K-1M</label>
                    <label><input type="radio" name="subCountFilter" value="1000000"> 1M+</label>
                </div>
                 
                 <!-- Upload Date Filter -->
                 <div class="filter-group date-filter">
                     <label>업로드일자 필터:</label>
                     <label><input type="radio" name="uploadDateFilter" value="all" checked> 전체</label>
                     <label><input type="radio" name="uploadDateFilter" value="1"> 최근 1일</label>
                     <label><input type="radio" name="uploadDateFilter" value="3"> 최근 3일</label>
                     <label><input type="radio" name="uploadDateFilter" value="7"> 최근 7일</label>
                     <label><input type="radio" name="uploadDateFilter" value="30"> 1개월 이내</label>
                     <label><input type="radio" name="uploadDateFilter" value="90"> 3개월 이내</label>
                     <label><input type="radio" name="uploadDateFilter" value="180"> 6개월 이내</label>
                    <label><input type="radio" name="uploadDateFilter" value="365"> 1년 이내</label>
                </div>
                
                <!-- Video Duration Filter -->
                <div class="filter-group duration-filter">
                    <label>영상길이 필터:</label>
                    <label><input type="radio" name="durationFilter" value="all" checked> 전체</label>
                    <label><input type="radio" name="durationFilter" value="0-60"> <1min</label>
                    <label><input type="radio" name="durationFilter" value="60-600"> 1min-10min</label>
                    <label><input type="radio" name="durationFilter" value="1200-3600"> 20min-1hour</label>
                    <label><input type="radio" name="durationFilter" value="3600"> 1hour+</label>
                </div>
            </div>

            <!-- Sort Options -->
            <div class="filter-group sort-filter">
                <label for="sortSelect">정렬:</label>
                <select id="sortSelect">
                    <option value="vpd_desc">일평균 조회수 높은순</option>
                    <option value="vpd_asc">일평균 조회수 낮은순</option>
                    <option value="view_desc">조회수 높은순</option>
                    <option value="view_asc">조회수 낮은순</option>
                    <option value="date_desc">최신순</option>
                    <option value="date_asc">오래된순</option>
                </select>
            </div>
        </div>

        <!-- Pagination Section -->
        <div class="pagination-section">
            <div class="result-summary" id="resultSummary">
                검색 결과: <span id="totalCount">0</span>개
            </div>
            <div class="pagination-bar">
                <button id="prevPage" class="page-btn" aria-label="Previous page">◀</button>
                <span id="pageInfo" class="page-info">1 / 1 page</span>
                <button id="nextPage" class="page-btn" aria-label="Next page">▶</button>
            </div>
        </div>

        <!-- Results Container -->
        <div id="results" class="results-container">
            <div class="loading">⏳ 검색 중...</div>
        </div>
    </div>

    <!-- 외부 JS 모듈 로드 (ES6 Module) -->
    <script type="module" src="js/main.js"></script>
    
    <!-- 전역 함수 (비밀번호 토글) -->
    <script>
        function togglePassword(inputId, toggleId) {
            const input = document.getElementById(inputId);
            const toggle = document.getElementById(toggleId);
            
            if (input.type === 'password') {
                input.type = 'text';
                toggle.textContent = '숨기기';
            } else {
                input.type = 'password';
                toggle.textContent = '보기';
            }
        }
    </script>
</body>
</html>
